"use strict";exports.id=740,exports.ids=[740],exports.modules={7236:(e,t,s)=>{s.d(t,{p:()=>k});var a=s(3972),r=s(3250),l=s.n(r),i=s(4554),n=s(77),o=s(8868),d=s(7264),c=s(2204),m=s(4060),u=s(9713),p=s(883),f=s(8456),x=s(6929),h=s(4320),g=s(3356),b=s(7697),M=s(4330),v=s(4476);s(4275),s(8471),s(74);let y=(0,s(4785).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var j=s(5705);function w({label:e,value:t,max:s=5,color:r="bg-lcd-green",className:l}){return(0,a.jsxs)("div",{className:(0,j.cn)("flex items-center gap-2",l),children:[a.jsx("span",{className:"w-20 text-xs font-bold text-lcd-green font-mono uppercase tracking-widest drop-shadow-lcd",children:e}),a.jsx("div",{className:"flex gap-1",children:Array.from({length:s}).map((e,s)=>a.jsx("div",{className:(0,j.cn)("h-3 w-6 rounded-[2px] border border-lcd-green transition-all duration-200",s<t?r:"bg-lcd-dark")},s))})]})}let N=[{id:"single-audio",title:"Single Audio File",description:"AI separates your audio into stems",icon:a.jsx(M.Z,{className:"h-6 w-6"}),stats:{complexity:1,speed:1,control:1},usesCredits:!0,color:"bg-emerald-600",gradient:"from-emerald-600 to-emerald-700"},{id:"stems",title:"Stems",description:"Upload pre-separated audio and/or MIDI stems for max control",icon:a.jsx(v.Z,{className:"h-6 w-6"}),stats:{complexity:3,speed:5,control:5},usesCredits:!1,color:"bg-emerald-600",gradient:"from-emerald-600 to-emerald-700"}];function C({isLoading:e,errors:t,onFilesChange:s}){let[r,i]=l().useState([]),[n,o]=l().useState(null),[d,m]=l().useState({}),u=l().useRef(null),[p,f]=l().useState(!1),x=[{value:"drums",label:"Drums"},{value:"bass",label:"Bass"},{value:"vocals",label:"Vocals"},{value:"melody",label:"Melody"}],h=()=>{u.current?.click()},g=(e,t)=>{m(s=>({...s,[e]:t}))};return(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"stems-files",className:"text-stone-200 font-medium",children:"Stems (Audio and/or MIDI)"}),(0,a.jsxs)("div",{className:(0,j.cn)("flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-6 transition-colors cursor-pointer bg-stone-800",p?"border-emerald-400 bg-stone-700/80":"border-stone-600 hover:border-emerald-400 hover:bg-stone-700/60"),onClick:h,onDrop:e=>{if(e.preventDefault(),f(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){let t=Array.from(e.dataTransfer.files);i(t),1===t.length&&o(t[0].name);let a={};t.forEach(e=>{let t=e.name.toLowerCase();t.includes("drum")?a[e.name]="drums":t.includes("bass")?a[e.name]="bass":t.includes("vocal")?a[e.name]="vocals":a[e.name]="melody"}),m(a),s(t,n,a)}},onDragOver:e=>{e.preventDefault(),f(!0)},onDragLeave:e=>{e.preventDefault(),f(!1)},tabIndex:0,role:"button","aria-label":"File upload dropzone",children:[a.jsx("div",{className:"text-stone-300 text-sm mb-2 select-none",children:"Drag and drop files here, or"}),a.jsx("button",{type:"button",className:"px-4 py-2 bg-emerald-400 text-stone-900 font-bold rounded shadow hover:bg-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-400",onClick:e=>{e.stopPropagation(),h()},disabled:e,children:"Browse"}),a.jsx("input",{id:"stems-files",ref:u,type:"file",accept:"audio/*,.mid,.midi",multiple:!0,disabled:e,onChange:e=>{if(e.target.files){let t=Array.from(e.target.files);i(t),1===t.length&&o(t[0].name);let a={};t.forEach(e=>{let t=e.name.toLowerCase();t.includes("drum")?a[e.name]="drums":t.includes("bass")?a[e.name]="bass":t.includes("vocal")?a[e.name]="vocals":a[e.name]="melody"}),m(a),s(t,n,a)}},className:"hidden"})]}),a.jsx("ul",{className:"mt-2 space-y-1",children:r.map(t=>(0,a.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"radio",name:"master-file",checked:n===t.name,onChange:()=>o(t.name),className:"accent-emerald-500",disabled:e}),(0,a.jsxs)("span",{className:n===t.name?"font-bold text-emerald-400":"",children:[t.type.startsWith("audio/")?"\uD83C\uDFB5":t.name.endsWith(".mid")||t.name.endsWith(".midi")?"\uD83C\uDFB9":"\uD83D\uDCC4",t.name,n===t.name&&a.jsx("span",{className:"ml-2 px-2 py-0.5 bg-emerald-600 text-xs rounded text-white",children:"MASTER"})]}),n!==t.name&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("select",{value:d[t.name]||"melody",onChange:e=>g(t.name,e.target.value),className:"ml-2 px-2 py-1 rounded border border-stone-600 bg-stone-900 text-stone-200 text-xs focus:outline-none focus:ring-emerald-400",disabled:e,children:x.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))}),a.jsx("span",{className:"ml-1 text-xs text-stone-400",children:d[t.name]?x.find(e=>e.value===d[t.name])?.label:"Melody"})]})]},t.name))}),a.jsx("p",{className:"text-xs text-stone-400",children:"You can upload audio stems, MIDI stems, or both."}),(0,a.jsxs)("p",{className:"text-xs text-stone-400",children:[a.jsx("span",{className:"font-bold text-emerald-400",children:"Step 1:"})," Select the master track with the radio button. ",a.jsx("br",{}),a.jsx("span",{className:"font-bold text-emerald-400",children:"Step 2:"})," Categorize all other files as stems."]}),t&&t["stems-files"]&&a.jsx("p",{className:"text-sm text-red-600",children:t["stems-files"].message}),!n&&r.length>0&&a.jsx("p",{className:"text-sm text-red-500",children:"Please select a master track."}),Object.values(d).filter(Boolean).length!==r.length&&r.length>0&&a.jsx("p",{className:"text-sm text-red-500",children:"Please tag each file with a stem type."})]})}function P({isLoading:e,onFileChange:t}){let s=l().useRef(null),[r,i]=l().useState(!1),[n,o]=l().useState(null),d=()=>{s.current?.click()};return(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"audio-file",className:"text-stone-200 font-medium",children:"Audio File"}),(0,a.jsxs)("div",{className:(0,j.cn)("flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-6 transition-colors cursor-pointer bg-stone-800",r?"border-emerald-400 bg-stone-700/80":"border-stone-600 hover:border-emerald-400 hover:bg-stone-700/60"),onClick:d,onDrop:e=>{e.preventDefault(),i(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&(o(e.dataTransfer.files[0]),t(e.dataTransfer.files[0]))},onDragOver:e=>{e.preventDefault(),i(!0)},onDragLeave:e=>{e.preventDefault(),i(!1)},tabIndex:0,role:"button","aria-label":"File upload dropzone",children:[a.jsx("div",{className:"text-stone-300 text-sm mb-2 select-none",children:"Drag and drop your audio file here, or"}),a.jsx("button",{type:"button",className:"px-4 py-2 bg-emerald-400 text-stone-900 font-bold rounded shadow hover:bg-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-400",onClick:e=>{e.stopPropagation(),d()},disabled:e,children:"Browse"}),a.jsx("input",{id:"audio-file",ref:s,type:"file",accept:"audio/*",disabled:e,onChange:e=>{e.target.files&&e.target.files[0]&&(o(e.target.files[0]),t(e.target.files[0]))},className:"hidden"})]}),n&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-stone-200 flex items-center gap-2",children:["\uD83C\uDFB5 ",n.name]}),a.jsx("p",{className:"text-xs text-stone-400",children:"This will use credits. Only one audio file allowed."})]})}function k({isOpen:e,onClose:t,defaultMidiFilePath:s}){let[l,M]=(0,r.useState)(null),[v,k]=(0,r.useState)(!1),[S,D]=(0,r.useState)(!1),[F,z]=(0,r.useState)([]),[U,E]=(0,r.useState)(null),[I,R]=(0,r.useState)({}),{toast:L}=(0,x.pm)(),_=(0,g.useRouter)(),{addAndUploadFiles:A}=(0,h.V)(),{register:$,handleSubmit:T,formState:{errors:O},reset:V,setValue:B,watch:J}=(0,i.cI)({resolver:(0,n.F)(f.UA),defaultValues:{privacy_setting:"private",midi_file_path:s||""}}),Y=b.S.project.create.useMutation({onSuccess:e=>{L({title:"Project Created! \uD83C\uDFB5",description:`"${e.name}" is ready for your creative vision.`}),V(),t(),_.push(`/creative-visualizer?projectId=${e.id}`)},onError:e=>{L({title:"Creation Failed",description:e.message||"Failed to create project. Please try again.",variant:"destructive"})},onSettled:()=>{k(!1)}}),q=b.S.file.uploadFile.useMutation({onSuccess:e=>{console.log("File uploaded successfully:",e.fileId)},onError:e=>{throw console.error("Upload error:",e),e}}),Z=b.S.useUtils(),W=async e=>{if("stems"===l&&(!U||F.length<2||Object.values(I).filter(Boolean).length!==F.length)){L({title:"Missing Tags",description:"You must select a master track, upload at least two files, and tag each file with a stem type.",variant:"destructive"});return}try{k(!0),console.log("Form submission data:",e);let t={name:e.name,description:e.description||"",privacy_setting:e.privacy_setting||"private",render_configuration:e.render_configuration||{}};console.log("=== DEBUG PROJECT CREATION ==="),console.log("projectData to send:",JSON.stringify(t,null,2)),console.log("projectData.name:",t.name),console.log("projectData.name type:",typeof t.name),console.log("=== END DEBUG ===");let s=await Y.mutateAsync(t);if(console.log("Project created:",s.id),"stems"===l&&F.length>0){let e=F.map(async e=>{let t;let a=await new Promise((t,s)=>{let a=new FileReader;a.onload=()=>{let e=a.result.split(",")[1];t(e)},a.onerror=s,a.readAsDataURL(e)}),r=e.name.toLowerCase().split(".").pop();if(["mid","midi"].includes(r||""))t="midi";else if(["mp3","wav","ogg","m4a","aac"].includes(r||""))t="audio";else if(["mp4","mov","avi","mkv","webm"].includes(r||""))t="video";else if(["jpg","jpeg","png","gif","bmp","webp"].includes(r||""))t="image";else throw Error(`Unsupported file type: ${r}`);return q.mutateAsync({fileName:e.name,fileType:t,mimeType:e.type||"application/octet-stream",fileSize:e.size,fileData:a,projectId:s.id,isMaster:e.name===U,stemType:e.name===U?"master":I[e.name]||"melody"})});try{(await Promise.all(e)).map(e=>e.fileId),Z.file.getUserFiles.invalidate()}catch(e){console.error("Upload error:",e),L({title:"Upload Failed",description:"Some files failed to upload. Please try again.",variant:"destructive"});return}}}catch(e){console.error("Form submission error:",e),L({title:"Upload Failed",description:e instanceof Error?e.message:"Failed to upload files or create project.",variant:"destructive"})}},G=()=>{v||(V(),M(null),D(!1),t())},H=e=>{M(e),D(!0)};return S?a.jsx(m.l,{isOpen:e,onClose:G,sizeClassName:"max-w-2xl min-h-[600px]",children:a.jsx("div",{className:"w-full h-full bg-stone-900 text-stone-200 font-mono border border-stone-700 rounded-xl max-h-[90vh] overflow-y-auto p-4 min-w-[340px]",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("button",{onClick:()=>{D(!1),M(null)},className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(y,{className:"h-5 w-5 rotate-180"})}),a.jsx("h2",{className:"text-2xl font-bold mb-2 text-stone-100",children:"Project Details"})]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Configure your ","single-audio"===l?"audio":"stems"," visualization project."]})]}),(0,a.jsxs)("form",{onSubmit:T(W),className:"space-y-6",children:[Object.keys(O).length>0&&(0,a.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[a.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Please fix the following errors:"}),a.jsx("ul",{className:"mt-1 text-sm text-red-600 list-disc list-inside",children:Object.entries(O).map(([e,t])=>a.jsx("li",{children:t?.message?.toString()||"Validation error"},e))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"name",className:"text-stone-200 font-medium",children:"Project Name *"}),a.jsx(d.I,{id:"name",placeholder:"My Amazing Song",...$("name"),disabled:v,className:"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-500 focus:ring-blue-500 focus:border-blue-500"}),O.name&&a.jsx("p",{className:"text-sm text-red-600",children:O.name.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(c._,{htmlFor:"description",className:"text-stone-200 font-medium",children:"Description"}),a.jsx("textarea",{id:"description",placeholder:"Describe your project, inspiration, or creative vision...",...$("description"),disabled:v,rows:3,className:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"}),O.description&&a.jsx("p",{className:"text-sm text-red-600",children:O.description.message})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(c._,{className:"text-stone-200 font-medium",children:"Privacy Setting"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[a.jsx("input",{type:"radio",id:"private",value:"private",...$("privacy_setting"),disabled:v,className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx(c._,{htmlFor:"private",className:"text-stone-200 font-medium cursor-pointer",children:"Private"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Only you can see this project"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[a.jsx("input",{type:"radio",id:"unlisted",value:"unlisted",...$("privacy_setting"),disabled:v,className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx(c._,{htmlFor:"unlisted",className:"text-stone-200 font-medium cursor-pointer",children:"Unlisted"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Accessible via direct link only"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[a.jsx("input",{type:"radio",id:"public",value:"public",...$("privacy_setting"),disabled:v,className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx(c._,{htmlFor:"public",className:"text-stone-200 font-medium cursor-pointer",children:"Public"}),a.jsx("span",{className:"text-sm text-gray-600",children:"Visible to everyone in the community"})]})]})]}),O.privacy_setting&&a.jsx("p",{className:"text-sm text-red-600",children:O.privacy_setting.message})]}),"single-audio"===l&&a.jsx(P,{isLoading:v,onFileChange:()=>{}}),"stems"===l&&a.jsx(C,{isLoading:v,errors:O,onFilesChange:(e,t,s)=>{z(e),E(t),R(s)}}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[a.jsx(o.z,{type:"button",variant:"outline",onClick:G,disabled:v,className:"flex-1 bg-white border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400",children:"Cancel"}),a.jsx(o.z,{type:"submit",disabled:v,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white border-none",children:v?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(u.T,{size:"sm"}),"Creating..."]}):"Create Project"})]})]})]})})}):a.jsx(m.l,{isOpen:e,onClose:G,sizeClassName:"max-w-md min-h-[300px]",children:(0,a.jsxs)("div",{className:"w-full h-full bg-stone-900 text-stone-200 font-mono border border-stone-700 rounded-xl max-h-[90vh] overflow-y-auto p-4 min-w-[340px]",children:[(0,a.jsxs)("div",{className:"mb-2",children:[a.jsx("h2",{className:"text-xl font-bold text-stone-200 mb-1 tracking-widest uppercase",children:"Choose Upload Method"}),a.jsx("p",{className:"text-stone-400 text-xs mb-2",children:"Select how you want to create your music visualization project."})]}),a.jsx("div",{className:"flex flex-col gap-3",children:N.map(e=>(0,a.jsxs)("div",{className:(0,j.cn)("flex items-center gap-4 p-3 rounded-lg border border-stone-700 bg-stone-800 cursor-pointer transition-all duration-150","hover:bg-stone-700"),onClick:()=>H(e.id),children:[a.jsx("div",{className:(0,j.cn)("flex-shrink-0 p-2 rounded-lg border border-stone-700",e.color),children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-base font-bold text-stone-200 uppercase tracking-widest mb-1",children:e.title}),a.jsx("p",{className:"text-xs text-stone-400 mb-2 truncate",children:e.description}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx(w,{label:"Complexity",value:e.stats.complexity,max:5,color:"bg-emerald-400"}),a.jsx(w,{label:"Speed",value:e.stats.speed,max:5,color:"bg-emerald-400"}),a.jsx(w,{label:"Control",value:e.stats.control,max:5,color:"bg-emerald-400"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[e.usesCredits&&a.jsx(p.C,{variant:"secondary",className:"bg-emerald-900/80 text-emerald-200 border border-emerald-700 font-mono text-[10px] px-2 py-1 uppercase tracking-widest",children:"Uses Credits"}),(0,a.jsxs)(o.z,{size:"sm",className:"bg-emerald-400 text-stone-900 border border-emerald-400 font-mono text-xs px-3 py-1 rounded-md shadow-none hover:bg-emerald-300 hover:text-stone-900",children:["Select",a.jsx(y,{className:"h-3 w-3 ml-1"})]})]})]},e.id))}),a.jsx("div",{className:"pt-3 flex gap-2 justify-end",children:a.jsx(o.z,{type:"button",variant:"outline",onClick:G,className:"bg-stone-900 border border-stone-700 text-stone-200 font-mono text-xs px-4 py-1 rounded-md hover:bg-stone-800 hover:text-stone-200",children:"Cancel"})})]})})}},883:(e,t,s)=>{s.d(t,{C:()=>n});var a=s(3972);s(3250);var r=s(7439),l=s(5705);let i=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:t,...s}){return a.jsx("div",{className:(0,l.cn)(i({variant:t}),e),...s})}},4564:(e,t,s)=>{s.d(t,{c:()=>i});var a=s(3972);s(3250);var r=s(4060),l=s(7041);let i=({isOpen:e,onClose:t,onConfirm:s,title:i,description:n,confirmText:o="Confirm",confirmVariant:d="danger"})=>(0,a.jsxs)(r.l,{isOpen:e,onClose:t,className:"max-w-lg w-auto min-w-[320px] px-6 py-8 flex flex-col items-center justify-center",children:[a.jsx("h2",{className:"text-xl font-bold text-stone-100 mb-2 text-center w-full",children:i}),n&&a.jsx("p",{className:"text-stone-300 mb-6 text-center w-full",children:n}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 mt-6 w-full",children:[a.jsx(l.n,{variant:"secondary",onClick:t,children:"Cancel"}),a.jsx(l.n,{variant:"danger"===d?"primary":d,onClick:s,children:o})]})]})},4060:(e,t,s)=>{s.d(t,{l:()=>y});var a=s(3972),r=s(3250),l=s(8609),i=s(1325),n=s(4724),o=s(2699),d=s(1492),c=s(3170);class m extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,d.R)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u({children:e,isPresent:t,anchorX:s,root:l}){let i=(0,r.useId)(),n=(0,r.useRef)(null),o=(0,r.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=(0,r.useContext)(c._);return(0,r.useInsertionEffect)(()=>{let{width:e,height:a,top:r,left:c,right:m}=o.current;if(t||!n.current||!e||!a)return;let u="left"===s?`left: ${c}`:`right: ${m}`;n.current.dataset.motionPopId=i;let p=document.createElement("style");d&&(p.nonce=d);let f=l??document.head;return f.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${u}px !important;
            top: ${r}px !important;
          }
        `),()=>{f.removeChild(p),f.contains(p)&&f.removeChild(p)}},[t]),(0,a.jsx)(m,{isPresent:t,childRef:n,sizeRef:o,children:r.cloneElement(e,{ref:n})})}let p=({children:e,initial:t,isPresent:s,onExitComplete:l,custom:n,presenceAffectsLayout:d,mode:c,anchorX:m,root:p})=>{let x=(0,i.h)(f),h=(0,r.useId)(),g=!0,b=(0,r.useMemo)(()=>(g=!1,{id:h,initial:t,isPresent:s,custom:n,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;l&&l()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[s,x,l]);return d&&g&&(b={...b}),(0,r.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[s]),r.useEffect(()=>{s||x.size||!l||l()},[s]),"popLayout"===c&&(e=(0,a.jsx)(u,{isPresent:s,anchorX:m,root:p,children:e})),(0,a.jsx)(o.O.Provider,{value:b,children:e})};function f(){return new Map}var x=s(1520);let h=e=>e.key||"";function g(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let b=({children:e,custom:t,initial:s=!0,onExitComplete:o,presenceAffectsLayout:d=!0,mode:c="sync",propagate:m=!1,anchorX:u="left",root:f})=>{let[b,M]=(0,x.oO)(m),v=(0,r.useMemo)(()=>g(e),[e]),y=m&&!b?[]:v.map(h),j=(0,r.useRef)(!0),w=(0,r.useRef)(v),N=(0,i.h)(()=>new Map),[C,P]=(0,r.useState)(v),[k,S]=(0,r.useState)(v);(0,n.L)(()=>{j.current=!1,w.current=v;for(let e=0;e<k.length;e++){let t=h(k[e]);y.includes(t)?N.delete(t):!0!==N.get(t)&&N.set(t,!1)}},[k,y.length,y.join("-")]);let D=[];if(v!==C){let e=[...v];for(let t=0;t<k.length;t++){let s=k[t],a=h(s);y.includes(a)||(e.splice(t,0,s),D.push(s))}return"wait"===c&&D.length&&(e=D),S(g(e)),P(v),null}let{forceRender:F}=(0,r.useContext)(l.p);return(0,a.jsx)(a.Fragment,{children:k.map(e=>{let r=h(e),l=(!m||!!b)&&(v===k||y.includes(r));return(0,a.jsx)(p,{isPresent:l,initial:(!j.current||!!s)&&void 0,custom:t,presenceAffectsLayout:d,mode:c,root:f,onExitComplete:l?void 0:()=>{if(!N.has(r))return;N.set(r,!0);let e=!0;N.forEach(t=>{t||(e=!1)}),e&&(F?.(),S(w.current),m&&M?.(),o&&o())},anchorX:u,children:e},r)})})};var M=s(1758),v=s(5705);let y=r.forwardRef(({isOpen:e,onClose:t,children:s,className:r,overlayClassName:l,sizeClassName:i},n)=>a.jsx(b,{children:e&&a.jsx(M.E.div,{className:(0,v.cn)("fixed inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/90 backdrop-blur",l),style:{WebkitBackdropFilter:"blur(8px)"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,children:a.jsx(M.E.div,{ref:n,className:(0,v.cn)("glass-modal relative z-10 w-full",i,r),initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},onClick:e=>e.stopPropagation(),layout:!0,children:s})})}));y.displayName="GlassModal"},7264:(e,t,s)=>{s.d(t,{I:()=>i});var a=s(3972),r=s(3250),l=s(5705);let i=r.forwardRef(({className:e,type:t,...s},r)=>a.jsx("input",{type:t,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...s}));i.displayName="Input"},2204:(e,t,s)=>{s.d(t,{_:()=>d});var a=s(3972),r=s(3250),l=s(6418),i=s(7439),n=s(5705);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...t},s)=>a.jsx(l.f,{ref:s,className:(0,n.cn)(o(),e),...t}));d.displayName=l.f.displayName},9713:(e,t,s)=>{s.d(t,{T:()=>i});var a=s(3972),r=s(3250),l=s(5705);let i=r.forwardRef(({size:e="md",variant:t="default",className:s},r)=>a.jsx("div",{ref:r,className:(0,l.cn)("animate-spin rounded-full",{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[e],{default:"border-2 border-stone-300 border-t-stone-600",glass:"border-2 border-white/30 border-t-white"}[t],s)}));i.displayName="LoadingSpinner"},9972:(e,t,s)=>{s.d(t,{S:()=>l});var a=s(3972);s(3250);var r=s(5705);function l({className:e,size:t="md"}){return a.jsx("pre",{className:(0,r.cn)("font-mono whitespace-pre text-gray-100 overflow-hidden w-full",{sm:"text-[2px] leading-[2px]",md:"text-[3px] leading-[3px]",lg:"text-[4px] leading-[4px]"}[t],e),children:`                                                                                                                    
                                                                                                                    
\`7MM"""Mq.\`7MMF'  \`7MMF' .g8""8q. \`7MN.   \`7MF' .g8""8q.     .g8"""bgd \`7MMF'   \`YMM'   \`MM'\`7MM"""Mq.\`7MMF'  \`7MMF'
  MM   \`MM. MM      MM .dP'    \`YM. MMN.    M .dP'    \`YM. .dP'     \`M   MM       VMA   ,V    MM   \`MM. MM      MM  
  MM   ,M9  MM      MM dM'      \`MM M YMb   M dM'      \`MM dM'       \`   MM        VMA ,V     MM   ,M9  MM      MM  
  MMmmdM9   MMmmmmmmMM MM        MM M  \`MN. M MM        MM MM            MM         VMMP      MMmmdM9   MMmmmmmmMM  
  MM        MM      MM MM.      ,MP M   \`MM.M MM.      ,MP MM.    \`7MMF' MM      ,   MM       MM        MM      MM  
  MM        MM      MM \`Mb.    ,dP' M     YMM \`Mb.    ,dP' \`Mb.     MM   MM     ,M   MM       MM        MM      MM  
.JMML.    .JMML.  .JMML. \`"bmmd"' .JML.    YM   \`"bmmd"'     \`"bmmmdPY .JMMmmmmMMM .JMML.   .JMML.    .JMML.  .JMML.
                                                                                                                    
                                                                                                                    `})}},7041:(e,t,s)=>{s.d(t,{n:()=>i});var a=s(3972),r=s(3250),l=s(5705);let i=r.forwardRef(({className:e,variant:t="primary",size:s="md",children:r,type:i="button",...n},o)=>a.jsx("button",{ref:o,type:i,className:(0,l.cn)({primary:"technical-button-primary",secondary:"technical-button-secondary"}[t],{sm:"px-3 py-2 text-xs",md:"px-6 py-3 text-sm",lg:"px-8 py-4 text-base"}[s],"transition-all duration-300 ease-in-out",e),...n,children:r}));i.displayName="TechnicalButton"},4320:(e,t,s)=>{s.d(t,{V:()=>i});var a=s(3250),r=s(6929),l=s(7697);function i(e={}){let{onUploadComplete:t,onUploadError:s,onAllUploadsComplete:i,maxConcurrentUploads:n=3,projectId:o}=e,[d,c]=(0,a.useState)([]),[m,u]=(0,a.useState)(!1),{toast:p}=(0,r.pm)();l.S.file.getUploadUrl.useMutation(),l.S.file.confirmUpload.useMutation();let f=l.S.file.uploadFile.useMutation(),x=(0,a.useCallback)(()=>`upload_${Date.now()}_${Math.random().toString(36).substring(2)}`,[]),h=(0,a.useCallback)(e=>{let t=[],s=[];return e.forEach(e=>{let a;let r=e.name.toLowerCase().split(".").pop(),l=["mid","midi","mp3","wav","mp4","mov","webm","jpg","jpeg","png","gif","webp"];if(!r||!l.includes(r)){s.push(`${e.name}: Invalid file type. Allowed types: ${l.join(", ")}`);return}let i=["mid","midi"].includes(r),n=["mp3","wav"].includes(r),o=["mp4","mov","webm"].includes(r),d=["jpg","jpeg","png","gif","webp"].includes(r);if(i)a=5242880;else if(n)a=52428800;else if(o)a=524288e3;else if(d)a=26214400;else{s.push(`${e.name}: Unsupported file type`);return}if(e.size>a){let t=a/1048576;s.push(`${e.name}: File too large. Maximum size: ${t}MB`);return}t.push(e)}),s.length>0&&p({title:"Invalid Files",description:s.join("\n"),variant:"destructive"}),t},[p]),g=(0,a.useCallback)(e=>{let t=h(e).map(e=>({file:e,id:x(),status:"pending",progress:0}));return c(e=>[...e,...t]),t},[x,h]),b=(0,a.useCallback)(e=>{c(t=>t.filter(t=>t.id!==e))},[]),M=(0,a.useCallback)(()=>{c([])},[]),v=(0,a.useCallback)((e,t)=>{c(s=>s.map(s=>s.id===e?{...s,...t}:s))},[]),y=(0,a.useCallback)(async e=>{try{v(e.id,{status:"uploading",progress:10});let s=new FileReader;await new Promise((a,r)=>{s.onload=async()=>{try{let r;let l=s.result.split(",")[1];v(e.id,{progress:30});let i=e.file.name.toLowerCase().split(".").pop();if(["mid","midi"].includes(i||""))r="midi";else if(["mp3","wav"].includes(i||""))r="audio";else if(["mp4","mov","webm"].includes(i||""))r="video";else if(["jpg","jpeg","png","gif","webp"].includes(i||""))r="image";else throw Error("Unsupported file type");let n=await f.mutateAsync({fileName:e.file.name,fileType:r,mimeType:e.file.type||"application/octet-stream",fileSize:e.file.size,fileData:l,projectId:o});v(e.id,{status:"completed",progress:100,fileId:n.fileId}),t?.({...e,fileId:n.fileId,status:"completed",progress:100}),a()}catch(e){r(e)}},s.onerror=()=>{r(Error("Failed to read file"))},s.readAsDataURL(e.file)}),v(e.id,{status:"completed",progress:100}),i?.()}catch(a){console.error("Upload error:",a);let t=a instanceof Error?a.message:"Upload failed";v(e.id,{status:"failed",error:t}),s?.(e,t)}},[v,f,t,s,i]),j=(0,a.useCallback)(async e=>{let t=h(e);if(0===t.length)return[];let s=t.map(e=>({file:e,id:x(),status:"pending",progress:0}));if(c(e=>[...e,...s]),s.length>0){u(!0);try{let e=[];for(let t=0;t<s.length;t+=n)e.push(s.slice(t,t+n));for(let t of e)await Promise.allSettled(t.map(e=>y(e)));i?.();let t=s.filter(e=>"completed"===e.status).length;t>0&&p({title:"Upload Complete",description:`Successfully uploaded ${t} file${t>1?"s":""}`})}catch(e){console.error("Upload error:",e),p({title:"Upload Error",description:"Upload failed",variant:"destructive"})}finally{u(!1)}}return s},[h,x,n,y,i,p]),w=(0,a.useCallback)(async()=>{let e=d.filter(e=>"pending"===e.status);if(0!==e.length){u(!0);try{let t=[];for(let s=0;s<e.length;s+=n)t.push(e.slice(s,s+n));for(let e of t)await Promise.allSettled(e.map(e=>y(e)));i?.();let s=d.filter(e=>"completed"===e.status).length;s>0&&p({title:"Upload Complete",description:`Successfully uploaded ${s} file${s>1?"s":""}`})}catch(e){console.error("Upload error:",e),p({title:"Upload Error",description:"Upload failed",variant:"destructive"})}finally{u(!1)}}},[d,n,y,i,p]),N=(0,a.useCallback)(async e=>{let t=d.find(t=>t.id===e);t&&"failed"===t.status&&(v(e,{status:"pending",progress:0,error:void 0}),await y(t))},[d,v,y]);return{files:d,isUploading:m,addFiles:g,addAndUploadFiles:j,removeFile:b,clearFiles:M,startUpload:w,retryUpload:N,pendingCount:d.filter(e=>"pending"===e.status).length,uploadingCount:d.filter(e=>"uploading"===e.status).length,completedCount:d.filter(e=>"completed"===e.status).length,failedCount:d.filter(e=>"failed"===e.status).length,totalProgress:d.length>0?Math.round(d.reduce((e,t)=>e+t.progress,0)/d.length):0}}},8456:(e,t,s)=>{s.d(t,{UA:()=>r.UA,dm:()=>l,if:()=>i});var a=s(7801),r=s(3407);let l=a.z.object({email:a.z.string().email("Please enter a valid email address"),password:a.z.string().min(6,"Password must be at least 6 characters")}),i=a.z.object({name:a.z.string().min(2,"Name must be at least 2 characters").optional(),email:a.z.string().email("Please enter a valid email address"),password:a.z.string().min(6,"Password must be at least 6 characters"),confirmPassword:a.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});a.z.object({email:a.z.string().email("Please enter a valid email address")}),a.z.object({password:a.z.string().min(6,"Password must be at least 6 characters"),confirmPassword:a.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]})},4476:(e,t,s)=>{s.d(t,{Z:()=>a});let a=(0,s(4785).Z)("file-audio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]])},954:(e,t,s)=>{s.d(t,{Z:()=>a});let a=(0,s(4785).Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}};