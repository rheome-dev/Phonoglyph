"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[218],{8030:function(e,t,s){s.d(t,{p:function(){return _}});var a=s(1279),r=s(12),n=s(3882),l=s(9096),i=s(1822),o=s(6580),c=s(8370),d=s(9767),u=s(759),m=s(9413),p=s(1898),f=s(5487),g=s(2609),x=s(6564),h=s(1909),b=s(4942),v=s(2018);s(9541),s(7766),s(4164);var M=s(169),y=s(8092);function j(e){let{label:t,value:s,max:r=5,color:n="bg-lcd-green",className:l}=e;return(0,a.jsxs)("div",{className:(0,y.cn)("flex items-center gap-2",l),children:[(0,a.jsx)("span",{className:"w-20 text-xs font-bold text-lcd-green font-mono uppercase tracking-widest drop-shadow-lcd",children:t}),(0,a.jsx)("div",{className:"flex gap-1",children:Array.from({length:r}).map((e,t)=>(0,a.jsx)("div",{className:(0,y.cn)("h-3 w-6 rounded-[2px] border border-lcd-green transition-all duration-200",t<s?n:"bg-lcd-dark")},t))})]})}let w=[{id:"single-audio",title:"Single Audio File",description:"AI separates your audio into stems",icon:(0,a.jsx)(b.Z,{className:"h-6 w-6"}),stats:{complexity:1,speed:1,control:1},usesCredits:!0,color:"bg-emerald-600",gradient:"from-emerald-600 to-emerald-700"},{id:"stems",title:"Stems",description:"Upload pre-separated audio and/or MIDI stems for max control",icon:(0,a.jsx)(v.Z,{className:"h-6 w-6"}),stats:{complexity:3,speed:5,control:5},usesCredits:!1,color:"bg-emerald-600",gradient:"from-emerald-600 to-emerald-700"}];function N(e){let{isLoading:t,errors:s,onFilesChange:n}=e,[l,i]=r.useState([]),[o,d]=r.useState(null),[u,m]=r.useState({}),p=r.useRef(null),[f,g]=r.useState(!1),x=[{value:"drums",label:"Drums"},{value:"bass",label:"Bass"},{value:"vocals",label:"Vocals"},{value:"melody",label:"Melody"}],h=()=>{var e;null===(e=p.current)||void 0===e||e.click()};r.useEffect(()=>{n(l,o,u)},[l,o,u]);let b=(e,t)=>{m(s=>({...s,[e]:t}))};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"stems-files",className:"text-stone-200 font-medium",children:"Stems (Audio and/or MIDI)"}),(0,a.jsxs)("div",{className:(0,y.cn)("flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-6 transition-colors cursor-pointer bg-stone-800",f?"border-emerald-400 bg-stone-700/80":"border-stone-600 hover:border-emerald-400 hover:bg-stone-700/60"),onClick:h,onDrop:e=>{if(e.preventDefault(),g(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){let t=Array.from(e.dataTransfer.files);i(t),1===t.length&&d(t[0].name);let s={};t.forEach(e=>{let t=e.name.toLowerCase();t.includes("drum")?s[e.name]="drums":t.includes("bass")?s[e.name]="bass":t.includes("vocal")?s[e.name]="vocals":s[e.name]="melody"}),m(s),n(t,o,s)}},onDragOver:e=>{e.preventDefault(),g(!0)},onDragLeave:e=>{e.preventDefault(),g(!1)},tabIndex:0,role:"button","aria-label":"File upload dropzone",children:[(0,a.jsx)("div",{className:"text-stone-300 text-sm mb-2 select-none",children:"Drag and drop files here, or"}),(0,a.jsx)("button",{type:"button",className:"px-4 py-2 bg-emerald-400 text-stone-900 font-bold rounded shadow hover:bg-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-400",onClick:e=>{e.stopPropagation(),h()},disabled:t,children:"Browse"}),(0,a.jsx)("input",{id:"stems-files",ref:p,type:"file",accept:"audio/*,.mid,.midi",multiple:!0,disabled:t,onChange:e=>{if(e.target.files){let t=Array.from(e.target.files);i(t),1===t.length&&d(t[0].name);let s={};t.forEach(e=>{let t=e.name.toLowerCase();t.includes("drum")?s[e.name]="drums":t.includes("bass")?s[e.name]="bass":t.includes("vocal")?s[e.name]="vocals":s[e.name]="melody"}),m(s),n(t,o,s)}},className:"hidden"})]}),(0,a.jsx)("ul",{className:"mt-2 space-y-1",children:l.map(e=>{var s;return(0,a.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"radio",name:"master-file",checked:o===e.name,onChange:()=>d(e.name),className:"accent-emerald-500",disabled:t}),(0,a.jsxs)("span",{className:o===e.name?"font-bold text-emerald-400":"",children:[e.type.startsWith("audio/")?"\uD83C\uDFB5":e.name.endsWith(".mid")||e.name.endsWith(".midi")?"\uD83C\uDFB9":"\uD83D\uDCC4",e.name,o===e.name&&(0,a.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-emerald-600 text-xs rounded text-white",children:"MASTER"})]}),o!==e.name&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("select",{value:u[e.name]||"melody",onChange:t=>b(e.name,t.target.value),className:"ml-2 px-2 py-1 rounded border border-stone-600 bg-stone-900 text-stone-200 text-xs focus:outline-none focus:ring-emerald-400",disabled:t,children:x.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)("span",{className:"ml-1 text-xs text-stone-400",children:u[e.name]?null===(s=x.find(t=>t.value===u[e.name]))||void 0===s?void 0:s.label:"Melody"})]})]},e.name)})}),(0,a.jsx)("p",{className:"text-xs text-stone-400",children:"You can upload audio stems, MIDI stems, or both."}),(0,a.jsxs)("p",{className:"text-xs text-stone-400",children:[(0,a.jsx)("span",{className:"font-bold text-emerald-400",children:"Step 1:"})," Select the master track with the radio button. ",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"font-bold text-emerald-400",children:"Step 2:"})," Categorize all other files as stems."]}),s&&s["stems-files"]&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:s["stems-files"].message}),!o&&l.length>0&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Please select a master track."}),Object.values(u).filter(Boolean).length!==l.length&&l.length>0&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:"Please tag each file with a stem type."})]})}function S(e){let{isLoading:t,onFileChange:s}=e,n=r.useRef(null),[l,i]=r.useState(!1),[o,d]=r.useState(null),u=()=>{var e;null===(e=n.current)||void 0===e||e.click()};return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"audio-file",className:"text-stone-200 font-medium",children:"Audio File"}),(0,a.jsxs)("div",{className:(0,y.cn)("flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-6 transition-colors cursor-pointer bg-stone-800",l?"border-emerald-400 bg-stone-700/80":"border-stone-600 hover:border-emerald-400 hover:bg-stone-700/60"),onClick:u,onDrop:e=>{e.preventDefault(),i(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&(d(e.dataTransfer.files[0]),s(e.dataTransfer.files[0]))},onDragOver:e=>{e.preventDefault(),i(!0)},onDragLeave:e=>{e.preventDefault(),i(!1)},tabIndex:0,role:"button","aria-label":"File upload dropzone",children:[(0,a.jsx)("div",{className:"text-stone-300 text-sm mb-2 select-none",children:"Drag and drop your audio file here, or"}),(0,a.jsx)("button",{type:"button",className:"px-4 py-2 bg-emerald-400 text-stone-900 font-bold rounded shadow hover:bg-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-400",onClick:e=>{e.stopPropagation(),u()},disabled:t,children:"Browse"}),(0,a.jsx)("input",{id:"audio-file",ref:n,type:"file",accept:"audio/*",disabled:t,onChange:e=>{e.target.files&&e.target.files[0]&&(d(e.target.files[0]),s(e.target.files[0]))},className:"hidden"})]}),o&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-stone-200 flex items-center gap-2",children:["\uD83C\uDFB5 ",o.name]}),(0,a.jsx)("p",{className:"text-xs text-stone-400",children:"This will use credits. Only one audio file allowed."})]})}function _(e){let{isOpen:t,onClose:s,defaultMidiFilePath:b}=e,[v,_]=(0,r.useState)(null),[C,D]=(0,r.useState)(!1),[I,E]=(0,r.useState)(!1),[P,A]=(0,r.useState)([]),[U,T]=(0,r.useState)(null),[k,F]=(0,r.useState)({}),{toast:G}=(0,f.pm)(),z=(0,x.useRouter)(),{addAndUploadFiles:O}=(0,g.V)(),{register:Y,handleSubmit:L,formState:{errors:R},reset:B,setValue:J,watch:K}=(0,n.cI)({resolver:(0,l.F)(p.UA),defaultValues:{privacy_setting:"private",midi_file_path:b||""}}),V=h.S.project.create.useMutation({onSuccess:e=>{G({title:"Project Created! \uD83C\uDFB5",description:'"'.concat(e.name,'" is ready for your creative vision.')}),B(),s(),z.push("/creative-visualizer?projectId=".concat(e.id))},onError:e=>{G({title:"Creation Failed",description:e.message||"Failed to create project. Please try again.",variant:"destructive"})},onSettled:()=>{D(!1)}}),q=h.S.file.uploadFile.useMutation({onSuccess:e=>{console.log("File uploaded successfully:",e.fileId)},onError:e=>{throw console.error("Upload error:",e),e}}),W=h.S.useUtils(),Z=async e=>{if("stems"===v&&(!U||P.length<2||Object.values(k).filter(Boolean).length!==P.length)){G({title:"Missing Tags",description:"You must select a master track, upload at least two files, and tag each file with a stem type.",variant:"destructive"});return}try{D(!0),console.log("Form submission data:",e);let t={name:e.name,description:e.description||"",privacy_setting:e.privacy_setting||"private",render_configuration:e.render_configuration||{}};console.log("=== DEBUG PROJECT CREATION ==="),console.log("projectData to send:",JSON.stringify(t,null,2)),console.log("projectData.name:",t.name),console.log("projectData.name type:",typeof t.name),console.log("=== END DEBUG ===");let s=await V.mutateAsync(t);if(console.log("Project created:",s.id),"stems"===v&&P.length>0){let e=P.map(async e=>{let t;let a=await new Promise((t,s)=>{let a=new FileReader;a.onload=()=>{let e=a.result.split(",")[1];t(e)},a.onerror=s,a.readAsDataURL(e)}),r=e.name.toLowerCase().split(".").pop();if(["mid","midi"].includes(r||""))t="midi";else if(["mp3","wav","ogg","m4a","aac"].includes(r||""))t="audio";else if(["mp4","mov","avi","mkv","webm"].includes(r||""))t="video";else if(["jpg","jpeg","png","gif","bmp","webp"].includes(r||""))t="image";else throw Error("Unsupported file type: ".concat(r));return q.mutateAsync({fileName:e.name,fileType:t,mimeType:e.type||"application/octet-stream",fileSize:e.size,fileData:a,projectId:s.id,isMaster:e.name===U,stemType:e.name===U?"master":k[e.name]||"melody"})});try{(await Promise.all(e)).map(e=>e.fileId),W.file.getUserFiles.invalidate()}catch(e){console.error("Upload error:",e),G({title:"Upload Failed",description:"Some files failed to upload. Please try again.",variant:"destructive"});return}}}catch(e){console.error("Form submission error:",e),G({title:"Upload Failed",description:e instanceof Error?e.message:"Failed to upload files or create project.",variant:"destructive"})}},X=()=>{C||(B(),_(null),E(!1),s())},H=e=>{_(e),E(!0)};return I?(0,a.jsx)(d.l,{isOpen:t,onClose:X,sizeClassName:"max-w-2xl min-h-[600px]",children:(0,a.jsx)("div",{className:"w-full h-full bg-stone-900 text-stone-200 font-mono border border-stone-700 rounded-xl max-h-[90vh] overflow-y-auto p-4 min-w-[340px]",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("button",{onClick:()=>{E(!1),_(null)},className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:(0,a.jsx)(M.Z,{className:"h-5 w-5 rotate-180"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-2 text-stone-100",children:"Project Details"})]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Configure your ","single-audio"===v?"audio":"stems"," visualization project."]})]}),(0,a.jsxs)("form",{onSubmit:L(Z),className:"space-y-6",children:[Object.keys(R).length>0&&(0,a.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:[(0,a.jsx)("p",{className:"text-sm text-red-600 font-medium",children:"Please fix the following errors:"}),(0,a.jsx)("ul",{className:"mt-1 text-sm text-red-600 list-disc list-inside",children:Object.entries(R).map(e=>{var t;let[s,r]=e;return(0,a.jsx)("li",{children:(null==r?void 0:null===(t=r.message)||void 0===t?void 0:t.toString())||"Validation error"},s)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"name",className:"text-stone-200 font-medium",children:"Project Name *"}),(0,a.jsx)(o.I,{id:"name",placeholder:"My Amazing Song",...Y("name"),disabled:C,className:"bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-500 focus:ring-blue-500 focus:border-blue-500"}),R.name&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:R.name.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"description",className:"text-stone-200 font-medium",children:"Description"}),(0,a.jsx)("textarea",{id:"description",placeholder:"Describe your project, inspiration, or creative vision...",...Y("description"),disabled:C,rows:3,className:"w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"}),R.description&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:R.description.message})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(c._,{className:"text-stone-200 font-medium",children:"Privacy Setting"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("input",{type:"radio",id:"private",value:"private",...Y("privacy_setting"),disabled:C,className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(c._,{htmlFor:"private",className:"text-stone-200 font-medium cursor-pointer",children:"Private"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Only you can see this project"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("input",{type:"radio",id:"unlisted",value:"unlisted",...Y("privacy_setting"),disabled:C,className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(c._,{htmlFor:"unlisted",className:"text-stone-200 font-medium cursor-pointer",children:"Unlisted"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Accessible via direct link only"})]})]}),(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("input",{type:"radio",id:"public",value:"public",...Y("privacy_setting"),disabled:C,className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-2"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(c._,{htmlFor:"public",className:"text-stone-200 font-medium cursor-pointer",children:"Public"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Visible to everyone in the community"})]})]})]}),R.privacy_setting&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:R.privacy_setting.message})]}),"single-audio"===v&&(0,a.jsx)(S,{isLoading:C,onFileChange:()=>{}}),"stems"===v&&(0,a.jsx)(N,{isLoading:C,errors:R,onFilesChange:(e,t,s)=>{A(e),T(t),F(s)}}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(i.z,{type:"button",variant:"outline",onClick:X,disabled:C,className:"flex-1 bg-white border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400",children:"Cancel"}),(0,a.jsx)(i.z,{type:"submit",disabled:C,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white border-none",children:C?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.T,{size:"sm"}),"Creating..."]}):"Create Project"})]})]})]})})}):(0,a.jsx)(d.l,{isOpen:t,onClose:X,sizeClassName:"max-w-md min-h-[300px]",children:(0,a.jsxs)("div",{className:"w-full h-full bg-stone-900 text-stone-200 font-mono border border-stone-700 rounded-xl max-h-[90vh] overflow-y-auto p-4 min-w-[340px]",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-stone-200 mb-1 tracking-widest uppercase",children:"Choose Upload Method"}),(0,a.jsx)("p",{className:"text-stone-400 text-xs mb-2",children:"Select how you want to create your music visualization project."})]}),(0,a.jsx)("div",{className:"flex flex-col gap-3",children:w.map(e=>(0,a.jsxs)("div",{className:(0,y.cn)("flex items-center gap-4 p-3 rounded-lg border border-stone-700 bg-stone-800 cursor-pointer transition-all duration-150","hover:bg-stone-700"),onClick:()=>H(e.id),children:[(0,a.jsx)("div",{className:(0,y.cn)("flex-shrink-0 p-2 rounded-lg border border-stone-700",e.color),children:e.icon}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-base font-bold text-stone-200 uppercase tracking-widest mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-stone-400 mb-2 truncate",children:e.description}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(j,{label:"Complexity",value:e.stats.complexity,max:5,color:"bg-emerald-400"}),(0,a.jsx)(j,{label:"Speed",value:e.stats.speed,max:5,color:"bg-emerald-400"}),(0,a.jsx)(j,{label:"Control",value:e.stats.control,max:5,color:"bg-emerald-400"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[e.usesCredits&&(0,a.jsx)(m.C,{variant:"secondary",className:"bg-emerald-900/80 text-emerald-200 border border-emerald-700 font-mono text-[10px] px-2 py-1 uppercase tracking-widest",children:"Uses Credits"}),(0,a.jsxs)(i.z,{size:"sm",className:"bg-emerald-400 text-stone-900 border border-emerald-400 font-mono text-xs px-3 py-1 rounded-md shadow-none hover:bg-emerald-300 hover:text-stone-900",children:["Select",(0,a.jsx)(M.Z,{className:"h-3 w-3 ml-1"})]})]})]},e.id))}),(0,a.jsx)("div",{className:"pt-3 flex gap-2 justify-end",children:(0,a.jsx)(i.z,{type:"button",variant:"outline",onClick:X,className:"bg-stone-900 border border-stone-700 text-stone-200 font-mono text-xs px-4 py-1 rounded-md hover:bg-stone-800 hover:text-stone-200",children:"Cancel"})})]})})}},9413:function(e,t,s){s.d(t,{C:function(){return i}});var a=s(1279);s(12);var r=s(5544),n=s(8092);let l=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},6998:function(e,t,s){s.d(t,{c:function(){return l}});var a=s(1279);s(12);var r=s(9767),n=s(7953);let l=e=>{let{isOpen:t,onClose:s,onConfirm:l,title:i,description:o,confirmText:c="Confirm",confirmVariant:d="danger"}=e;return(0,a.jsxs)(r.l,{isOpen:t,onClose:s,className:"max-w-lg w-auto min-w-[320px] px-6 py-8 flex flex-col items-center justify-center",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-stone-100 mb-2 text-center w-full",children:i}),o&&(0,a.jsx)("p",{className:"text-stone-300 mb-6 text-center w-full",children:o}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 mt-6 w-full",children:[(0,a.jsx)(n.n,{variant:"secondary",onClick:s,children:"Cancel"}),(0,a.jsx)(n.n,{variant:"danger"===d?"primary":d,onClick:l,children:c})]})]})}},9767:function(e,t,s){s.d(t,{l:function(){return o}});var a=s(1279),r=s(12),n=s(1693),l=s(3133),i=s(8092);let o=r.forwardRef((e,t)=>{let{isOpen:s,onClose:r,children:o,className:c,overlayClassName:d,sizeClassName:u}=e;return(0,a.jsx)(n.M,{children:s&&(0,a.jsx)(l.E.div,{className:(0,i.cn)("fixed inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/90 backdrop-blur",d),style:{WebkitBackdropFilter:"blur(8px)"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:(0,a.jsx)(l.E.div,{ref:t,className:(0,i.cn)("glass-modal relative z-10 w-full",u,c),initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},onClick:e=>e.stopPropagation(),layout:!0,children:o})})})});o.displayName="GlassModal"},6580:function(e,t,s){s.d(t,{I:function(){return l}});var a=s(1279),r=s(12),n=s(8092);let l=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});l.displayName="Input"},8370:function(e,t,s){s.d(t,{_:function(){return c}});var a=s(1279),r=s(12),n=s(3343),l=s(5544),i=s(8092);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,i.cn)(o(),s),...r})});c.displayName=n.f.displayName},759:function(e,t,s){s.d(t,{T:function(){return l}});var a=s(1279),r=s(12),n=s(8092);let l=r.forwardRef((e,t)=>{let{size:s="md",variant:r="default",className:l}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("animate-spin rounded-full",{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[s],{default:"border-2 border-stone-300 border-t-stone-600",glass:"border-2 border-white/30 border-t-white"}[r],l)})});l.displayName="LoadingSpinner"},5003:function(e,t,s){s.d(t,{S:function(){return n}});var a=s(1279);s(12);var r=s(8092);function n(e){let{className:t,size:s="md"}=e;return(0,a.jsx)("pre",{className:(0,r.cn)("font-mono whitespace-pre text-gray-100 overflow-hidden w-full",{sm:"text-[2px] leading-[2px]",md:"text-[3px] leading-[3px]",lg:"text-[4px] leading-[4px]"}[s],t),children:"                                                                                                                    \n                                                                                                                    \n`7MM\"\"\"Mq.`7MMF'  `7MMF' .g8\"\"8q. `7MN.   `7MF' .g8\"\"8q.     .g8\"\"\"bgd `7MMF'   `YMM'   `MM'`7MM\"\"\"Mq.`7MMF'  `7MMF'\n  MM   `MM. MM      MM .dP'    `YM. MMN.    M .dP'    `YM. .dP'     `M   MM       VMA   ,V    MM   `MM. MM      MM  \n  MM   ,M9  MM      MM dM'      `MM M YMb   M dM'      `MM dM'       `   MM        VMA ,V     MM   ,M9  MM      MM  \n  MMmmdM9   MMmmmmmmMM MM        MM M  `MN. M MM        MM MM            MM         VMMP      MMmmdM9   MMmmmmmmMM  \n  MM        MM      MM MM.      ,MP M   `MM.M MM.      ,MP MM.    `7MMF' MM      ,   MM       MM        MM      MM  \n  MM        MM      MM `Mb.    ,dP' M     YMM `Mb.    ,dP' `Mb.     MM   MM     ,M   MM       MM        MM      MM  \n.JMML.    .JMML.  .JMML. `\"bmmd\"' .JML.    YM   `\"bmmd\"'     `\"bmmmdPY .JMMmmmmMMM .JMML.   .JMML.    .JMML.  .JMML.\n                                                                                                                    \n                                                                                                                    "})}},7953:function(e,t,s){s.d(t,{n:function(){return l}});var a=s(1279),r=s(12),n=s(8092);let l=r.forwardRef((e,t)=>{let{className:s,variant:r="primary",size:l="md",children:i,type:o="button",...c}=e;return(0,a.jsx)("button",{ref:t,type:o,className:(0,n.cn)({primary:"technical-button-primary",secondary:"technical-button-secondary"}[r],{sm:"px-3 py-2 text-xs",md:"px-6 py-3 text-sm",lg:"px-8 py-4 text-base"}[l],"transition-all duration-300 ease-in-out",s),...c,children:i})});l.displayName="TechnicalButton"},2609:function(e,t,s){s.d(t,{V:function(){return l}});var a=s(12),r=s(5487),n=s(1909);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onUploadComplete:t,onUploadError:s,onAllUploadsComplete:l,maxConcurrentUploads:i=3,projectId:o}=e,[c,d]=(0,a.useState)([]),[u,m]=(0,a.useState)(!1),{toast:p}=(0,r.pm)();n.S.file.getUploadUrl.useMutation(),n.S.file.confirmUpload.useMutation();let f=n.S.file.uploadFile.useMutation(),g=(0,a.useCallback)(()=>"upload_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2)),[]),x=(0,a.useCallback)(e=>{let t=[],s=[];return e.forEach(e=>{let a;let r=e.name.toLowerCase().split(".").pop(),n=["mid","midi","mp3","wav","mp4","mov","webm","jpg","jpeg","png","gif","webp"];if(!r||!n.includes(r)){s.push("".concat(e.name,": Invalid file type. Allowed types: ").concat(n.join(", ")));return}let l=["mid","midi"].includes(r),i=["mp3","wav"].includes(r),o=["mp4","mov","webm"].includes(r),c=["jpg","jpeg","png","gif","webp"].includes(r);if(l)a=5242880;else if(i)a=52428800;else if(o)a=524288e3;else if(c)a=26214400;else{s.push("".concat(e.name,": Unsupported file type"));return}if(e.size>a){let t=a/1048576;s.push("".concat(e.name,": File too large. Maximum size: ").concat(t,"MB"));return}t.push(e)}),s.length>0&&p({title:"Invalid Files",description:s.join("\n"),variant:"destructive"}),t},[p]),h=(0,a.useCallback)(e=>{let t=x(e).map(e=>({file:e,id:g(),status:"pending",progress:0}));return d(e=>[...e,...t]),t},[g,x]),b=(0,a.useCallback)(e=>{d(t=>t.filter(t=>t.id!==e))},[]),v=(0,a.useCallback)(()=>{d([])},[]),M=(0,a.useCallback)((e,t)=>{d(s=>s.map(s=>s.id===e?{...s,...t}:s))},[]),y=(0,a.useCallback)(async e=>{try{M(e.id,{status:"uploading",progress:10});let s=new FileReader;await new Promise((a,r)=>{s.onload=async()=>{try{let r;let n=s.result.split(",")[1];M(e.id,{progress:30});let l=e.file.name.toLowerCase().split(".").pop();if(["mid","midi"].includes(l||""))r="midi";else if(["mp3","wav"].includes(l||""))r="audio";else if(["mp4","mov","webm"].includes(l||""))r="video";else if(["jpg","jpeg","png","gif","webp"].includes(l||""))r="image";else throw Error("Unsupported file type");let i=await f.mutateAsync({fileName:e.file.name,fileType:r,mimeType:e.file.type||"application/octet-stream",fileSize:e.file.size,fileData:n,projectId:o});M(e.id,{status:"completed",progress:100,fileId:i.fileId}),null==t||t({...e,fileId:i.fileId,status:"completed",progress:100}),a()}catch(e){r(e)}},s.onerror=()=>{r(Error("Failed to read file"))},s.readAsDataURL(e.file)}),M(e.id,{status:"completed",progress:100}),null==l||l()}catch(a){console.error("Upload error:",a);let t=a instanceof Error?a.message:"Upload failed";M(e.id,{status:"failed",error:t}),null==s||s(e,t)}},[M,f,t,s,l]),j=(0,a.useCallback)(async e=>{let t=x(e);if(0===t.length)return[];let s=t.map(e=>({file:e,id:g(),status:"pending",progress:0}));if(d(e=>[...e,...s]),s.length>0){m(!0);try{let e=[];for(let t=0;t<s.length;t+=i)e.push(s.slice(t,t+i));for(let t of e)await Promise.allSettled(t.map(e=>y(e)));null==l||l();let t=s.filter(e=>"completed"===e.status).length;t>0&&p({title:"Upload Complete",description:"Successfully uploaded ".concat(t," file").concat(t>1?"s":"")})}catch(e){console.error("Upload error:",e),p({title:"Upload Error",description:"Upload failed",variant:"destructive"})}finally{m(!1)}}return s},[x,g,i,y,l,p]),w=(0,a.useCallback)(async()=>{let e=c.filter(e=>"pending"===e.status);if(0!==e.length){m(!0);try{let t=[];for(let s=0;s<e.length;s+=i)t.push(e.slice(s,s+i));for(let e of t)await Promise.allSettled(e.map(e=>y(e)));null==l||l();let s=c.filter(e=>"completed"===e.status).length;s>0&&p({title:"Upload Complete",description:"Successfully uploaded ".concat(s," file").concat(s>1?"s":"")})}catch(e){console.error("Upload error:",e),p({title:"Upload Error",description:"Upload failed",variant:"destructive"})}finally{m(!1)}}},[c,i,y,l,p]),N=(0,a.useCallback)(async e=>{let t=c.find(t=>t.id===e);t&&"failed"===t.status&&(M(e,{status:"pending",progress:0,error:void 0}),await y(t))},[c,M,y]);return{files:c,isUploading:u,addFiles:h,addAndUploadFiles:j,removeFile:b,clearFiles:v,startUpload:w,retryUpload:N,pendingCount:c.filter(e=>"pending"===e.status).length,uploadingCount:c.filter(e=>"uploading"===e.status).length,completedCount:c.filter(e=>"completed"===e.status).length,failedCount:c.filter(e=>"failed"===e.status).length,totalProgress:c.length>0?Math.round(c.reduce((e,t)=>e+t.progress,0)/c.length):0}}},4939:function(e,t,s){s.d(t,{C:function(){return r}});class a{createGuestSession(){let e=this.getStoredSessionId();return(!e||this.isSessionExpired(e))&&(e=this.generateSessionId(),this.storeSessionId(e)),{id:"guest_".concat(e),isGuest:!0,sessionId:e,createdAt:new Date().toISOString(),tempData:this.loadGuestData(e)}}getCurrentGuestUser(){let e=this.getStoredSessionId();return!e||this.isSessionExpired(e)?null:{id:"guest_".concat(e),isGuest:!0,sessionId:e,createdAt:this.getSessionCreatedAt(e)||new Date().toISOString(),tempData:this.loadGuestData(e)}}saveGuestProject(e){let t={...e,id:"guest_project_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+this.DATA_EXPIRY).toISOString()},s=this.getGuestProjects(e.guestUserId);return s.push(t),this.saveGuestProjects(e.guestUserId,s),t}getGuestProjects(e){let t="".concat(this.GUEST_DATA_KEY,"_").concat(e,"_projects"),s=localStorage.getItem(t);if(!s)return[];try{let t=JSON.parse(s),a=t.filter(e=>!this.isDataExpired(e.expiresAt));return a.length!==t.length&&this.saveGuestProjects(e,a),a}catch(e){return[]}}transferGuestDataToUser(e,t){let s=this.getGuestProjects(e),a=this.getGuestPreferences(e);return this.clearGuestData(e),{projects:s,preferences:a}}clearGuestSession(){let e=this.getStoredSessionId();e&&(this.clearGuestData("guest_".concat(e)),localStorage.removeItem(this.GUEST_SESSION_KEY),localStorage.removeItem("".concat(this.GUEST_SESSION_KEY,"_created")))}shouldShowConversionPrompt(e){let t=this.getGuestProjects(e.id),s=Date.now()-new Date(e.createdAt).getTime();return t.length>0||s>72e5}generateSessionId(){return"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}getStoredSessionId(){return localStorage.getItem(this.GUEST_SESSION_KEY)}storeSessionId(e){localStorage.setItem(this.GUEST_SESSION_KEY,e),localStorage.setItem("".concat(this.GUEST_SESSION_KEY,"_created"),new Date().toISOString())}getSessionCreatedAt(e){return localStorage.getItem("".concat(this.GUEST_SESSION_KEY,"_created"))}isSessionExpired(e){let t=this.getSessionCreatedAt(e);return!t||Date.now()-new Date(t).getTime()>this.SESSION_DURATION}isDataExpired(e){return new Date(e).getTime()<Date.now()}loadGuestData(e){let t="".concat(this.GUEST_DATA_KEY,"_guest_").concat(e),s=localStorage.getItem(t);if(!s)return{projects:[],preferences:{}};try{return JSON.parse(s)}catch(e){return{projects:[],preferences:{}}}}saveGuestProjects(e,t){let s="".concat(this.GUEST_DATA_KEY,"_").concat(e,"_projects");localStorage.setItem(s,JSON.stringify(t))}getGuestPreferences(e){let t="".concat(this.GUEST_DATA_KEY,"_").concat(e,"_preferences"),s=localStorage.getItem(t);if(!s)return{};try{return JSON.parse(s)}catch(e){return{}}}clearGuestData(e){["".concat(this.GUEST_DATA_KEY,"_").concat(e),"".concat(this.GUEST_DATA_KEY,"_").concat(e,"_projects"),"".concat(this.GUEST_DATA_KEY,"_").concat(e,"_preferences")].forEach(e=>localStorage.removeItem(e))}constructor(){this.GUEST_SESSION_KEY="guest_session_id",this.GUEST_DATA_KEY="guest_user_data",this.SESSION_DURATION=864e5,this.DATA_EXPIRY=6048e5}}let r=new a},1909:function(e,t,s){s.d(t,{S:function(){return m},u:function(){return p}});var a=s(8032),r=s(3557),n=s(8148),l=s(4939);let i=null,o=null,c=async()=>i||o||(o=n.O.auth.getSession(),i=(await o).data.session,o=null,i);n.O.auth.onAuthStateChange(()=>{i=null,o=null});let d="http://localhost:3001";console.log("\uD83D\uDD27 tRPC API URL Debug:",{envVar:"http://localhost:3001",apiUrl:d,isClient:!0,finalUrl:"".concat(d,"/api/trpc"),environment:"production"}),d||console.error("âŒ NEXT_PUBLIC_API_URL is not set! This will cause API calls to fail.");let u=[()=>e=>{var t;let{next:s,op:a}=e;return t=e=>{let t=async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{let n=await c();if(!n&&r<10){setTimeout(()=>t(r+1),(r+1)*200);return}let i={};if(null==n?void 0:n.access_token)i.Authorization="Bearer ".concat(n.access_token);else{let e=l.C.getCurrentGuestUser();(null==e?void 0:e.sessionId)&&(i["x-guest-session"]=e.sessionId)}let o={...a,context:{...a.context,headers:i}};s(o).subscribe(e)}catch(t){console.warn("Auth link error, attempting request without auth:",t),s({...a,context:a.context}).subscribe(e)}};return t(),()=>{}},{subscribe:e=>(t(e),{unsubscribe(){}}),pipe(){return this}}},(0,r.ch)({url:"".concat(d,"/api/trpc"),fetch:async(e,t)=>{try{let s=await c(),a={"Content-Type":"application/json",...(null==t?void 0:t.headers)||{}};if(null==s?void 0:s.access_token)a.Authorization="Bearer ".concat(s.access_token);else{let e=l.C.getCurrentGuestUser();(null==e?void 0:e.sessionId)&&(a["x-guest-session"]=e.sessionId)}let r=await fetch(e,{...t||{},headers:a});return r.ok||console.warn("HTTP ".concat(r.status,": ").concat(r.statusText," for ").concat(e)),r}catch(e){throw console.error("Network error in tRPC request:",e),e}}})],m=(0,a.ec)(),p=m.createClient({links:u})},1898:function(e,t,s){s.d(t,{UA:function(){return r.UA},dm:function(){return n},if:function(){return l}});var a=s(4893),r=s(9494);let n=a.z.object({email:a.z.string().email("Please enter a valid email address"),password:a.z.string().min(6,"Password must be at least 6 characters")}),l=a.z.object({name:a.z.string().min(2,"Name must be at least 2 characters").optional(),email:a.z.string().email("Please enter a valid email address"),password:a.z.string().min(6,"Password must be at least 6 characters"),confirmPassword:a.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});a.z.object({email:a.z.string().email("Please enter a valid email address")}),a.z.object({password:a.z.string().min(6,"Password must be at least 6 characters"),confirmPassword:a.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]})}}]);