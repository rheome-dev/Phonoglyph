(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1656:function(t,e,s){Promise.resolve().then(s.t.bind(s,3693,23)),Promise.resolve().then(s.bind(s,3559)),Promise.resolve().then(s.bind(s,4693)),Promise.resolve().then(s.t.bind(s,5078,23))},3559:function(t,e,s){"use strict";s.d(e,{TRPCProvider:function(){return c}});var r=s(1279),n=s(12),o=s(5011),a=s(5828),i=s(1909);function c(t){let{children:e}=t,[s]=(0,n.useState)(()=>new o.S);return(0,r.jsx)(i.S.Provider,{client:i.u,queryClient:s,children:(0,r.jsx)(a.aH,{client:s,children:e})})}},4693:function(t,e,s){"use strict";s.d(e,{Toaster:function(){return m}});var r=s(1279),n=s(5487),o=s(12),a=s(7939),i=s(5544),c=s(6738),u=s(8092);let l=a.zt,d=o.forwardRef((t,e)=>{let{className:s,...n}=t;return(0,r.jsx)(a.l_,{ref:e,className:(0,u.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...n})});d.displayName=a.l_.displayName;let f=(0,i.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),h=o.forwardRef((t,e)=>{let{className:s,variant:n,...o}=t;return(0,r.jsx)(a.fC,{ref:e,className:(0,u.cn)(f({variant:n}),s),...o})});h.displayName=a.fC.displayName,o.forwardRef((t,e)=>{let{className:s,...n}=t;return(0,r.jsx)(a.aU,{ref:e,className:(0,u.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...n})}).displayName=a.aU.displayName;let p=o.forwardRef((t,e)=>{let{className:s,...n}=t;return(0,r.jsx)(a.x8,{ref:e,className:(0,u.cn)("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...n,children:(0,r.jsx)(c.Z,{className:"h-4 w-4"})})});p.displayName=a.x8.displayName;let S=o.forwardRef((t,e)=>{let{className:s,...n}=t;return(0,r.jsx)(a.Dx,{ref:e,className:(0,u.cn)("text-sm font-semibold [&+div]:text-xs",s),...n})});S.displayName=a.Dx.displayName;let g=o.forwardRef((t,e)=>{let{className:s,...n}=t;return(0,r.jsx)(a.dk,{ref:e,className:(0,u.cn)("text-sm opacity-90",s),...n})});function m(){let{toasts:t}=(0,n.pm)();return(0,r.jsxs)(l,{children:[t.map(function(t){let{id:e,title:s,description:n,action:o,...a}=t;return(0,r.jsxs)(h,{...a,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[s&&(0,r.jsx)(S,{children:s}),n&&(0,r.jsx)(g,{children:n})]}),o,(0,r.jsx)(p,{})]},e)}),(0,r.jsx)(d,{})]})}g.displayName=a.dk.displayName},5487:function(t,e,s){"use strict";s.d(e,{pm:function(){return f}});var r=s(12);let n=0,o=new Map,a=t=>{if(o.has(t))return;let e=setTimeout(()=>{o.delete(t),l({type:"REMOVE_TOAST",toastId:t})},1e6);o.set(t,e)},i=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:s}=e;return s?a(s):t.toasts.forEach(t=>{a(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===s||void 0===s?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},c=[],u={toasts:[]};function l(t){u=i(u,t),c.forEach(t=>{t(u)})}function d(t){let{...e}=t,s=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>l({type:"DISMISS_TOAST",toastId:s});return l({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:t=>{t||r()}}}),{id:s,dismiss:r,update:t=>l({type:"UPDATE_TOAST",toast:{...t,id:s}})}}function f(){let[t,e]=r.useState(u);return r.useEffect(()=>(c.push(e),()=>{let t=c.indexOf(e);t>-1&&c.splice(t,1)}),[t]),{...t,toast:d,dismiss:t=>l({type:"DISMISS_TOAST",toastId:t})}}},4939:function(t,e,s){"use strict";s.d(e,{C:function(){return n}});class r{createGuestSession(){let t=this.getStoredSessionId();return(!t||this.isSessionExpired(t))&&(t=this.generateSessionId(),this.storeSessionId(t)),{id:"guest_".concat(t),isGuest:!0,sessionId:t,createdAt:new Date().toISOString(),tempData:this.loadGuestData(t)}}getCurrentGuestUser(){let t=this.getStoredSessionId();return!t||this.isSessionExpired(t)?null:{id:"guest_".concat(t),isGuest:!0,sessionId:t,createdAt:this.getSessionCreatedAt(t)||new Date().toISOString(),tempData:this.loadGuestData(t)}}saveGuestProject(t){let e={...t,id:"guest_project_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+this.DATA_EXPIRY).toISOString()},s=this.getGuestProjects(t.guestUserId);return s.push(e),this.saveGuestProjects(t.guestUserId,s),e}getGuestProjects(t){let e="".concat(this.GUEST_DATA_KEY,"_").concat(t,"_projects"),s=localStorage.getItem(e);if(!s)return[];try{let e=JSON.parse(s),r=e.filter(t=>!this.isDataExpired(t.expiresAt));return r.length!==e.length&&this.saveGuestProjects(t,r),r}catch(t){return[]}}transferGuestDataToUser(t,e){let s=this.getGuestProjects(t),r=this.getGuestPreferences(t);return this.clearGuestData(t),{projects:s,preferences:r}}clearGuestSession(){let t=this.getStoredSessionId();t&&(this.clearGuestData("guest_".concat(t)),localStorage.removeItem(this.GUEST_SESSION_KEY),localStorage.removeItem("".concat(this.GUEST_SESSION_KEY,"_created")))}shouldShowConversionPrompt(t){let e=this.getGuestProjects(t.id),s=Date.now()-new Date(t.createdAt).getTime();return e.length>0||s>72e5}generateSessionId(){return"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}getStoredSessionId(){return localStorage.getItem(this.GUEST_SESSION_KEY)}storeSessionId(t){localStorage.setItem(this.GUEST_SESSION_KEY,t),localStorage.setItem("".concat(this.GUEST_SESSION_KEY,"_created"),new Date().toISOString())}getSessionCreatedAt(t){return localStorage.getItem("".concat(this.GUEST_SESSION_KEY,"_created"))}isSessionExpired(t){let e=this.getSessionCreatedAt(t);return!e||Date.now()-new Date(e).getTime()>this.SESSION_DURATION}isDataExpired(t){return new Date(t).getTime()<Date.now()}loadGuestData(t){let e="".concat(this.GUEST_DATA_KEY,"_guest_").concat(t),s=localStorage.getItem(e);if(!s)return{projects:[],preferences:{}};try{return JSON.parse(s)}catch(t){return{projects:[],preferences:{}}}}saveGuestProjects(t,e){let s="".concat(this.GUEST_DATA_KEY,"_").concat(t,"_projects");localStorage.setItem(s,JSON.stringify(e))}getGuestPreferences(t){let e="".concat(this.GUEST_DATA_KEY,"_").concat(t,"_preferences"),s=localStorage.getItem(e);if(!s)return{};try{return JSON.parse(s)}catch(t){return{}}}clearGuestData(t){["".concat(this.GUEST_DATA_KEY,"_").concat(t),"".concat(this.GUEST_DATA_KEY,"_").concat(t,"_projects"),"".concat(this.GUEST_DATA_KEY,"_").concat(t,"_preferences")].forEach(t=>localStorage.removeItem(t))}constructor(){this.GUEST_SESSION_KEY="guest_session_id",this.GUEST_DATA_KEY="guest_user_data",this.SESSION_DURATION=864e5,this.DATA_EXPIRY=6048e5}}let n=new r},8148:function(t,e,s){"use strict";s.d(e,{O:function(){return a}});var r=s(3895);let n="https://ahqgihozxzpyxrgesnxm.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFocWdpaG96eHpweXhyZ2VzbnhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5MTAyMDIsImV4cCI6MjA2NjQ4NjIwMn0.cT8XhsaPazK72VbeKQF8izhiedgEdmNqwZp2hB5nYfQ";n&&o||console.error("\uD83D\uDD25 SUPABASE NOT CONFIGURED! Auth and database will not work.");let a=(0,r.eI)(n||"https://dummy.supabase.co",o||"dummy-key")},1909:function(t,e,s){"use strict";s.d(e,{S:function(){return f},u:function(){return h}});var r=s(8032),n=s(3557),o=s(8148),a=s(4939);let i=null,c=null,u=async()=>i||c||(c=o.O.auth.getSession(),i=(await c).data.session,c=null,i);o.O.auth.onAuthStateChange(()=>{i=null,c=null});let l="http://localhost:3001";console.log("\uD83D\uDD27 tRPC API URL Debug:",{envVar:"http://localhost:3001",apiUrl:l,isClient:!0,finalUrl:"".concat(l,"/api/trpc"),environment:"production"}),l||console.error("âŒ NEXT_PUBLIC_API_URL is not set! This will cause API calls to fail.");let d=[()=>t=>{var e;let{next:s,op:r}=t;return e=t=>{let e=async function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{let o=await u();if(!o&&n<10){setTimeout(()=>e(n+1),(n+1)*200);return}let i={};if(null==o?void 0:o.access_token)i.Authorization="Bearer ".concat(o.access_token);else{let t=a.C.getCurrentGuestUser();(null==t?void 0:t.sessionId)&&(i["x-guest-session"]=t.sessionId)}let c={...r,context:{...r.context,headers:i}};s(c).subscribe(t)}catch(e){console.warn("Auth link error, attempting request without auth:",e),s({...r,context:r.context}).subscribe(t)}};return e(),()=>{}},{subscribe:t=>(e(t),{unsubscribe(){}}),pipe(){return this}}},(0,n.ch)({url:"".concat(l,"/api/trpc"),fetch:async(t,e)=>{try{let s=await u(),r={"Content-Type":"application/json",...(null==e?void 0:e.headers)||{}};if(null==s?void 0:s.access_token)r.Authorization="Bearer ".concat(s.access_token);else{let t=a.C.getCurrentGuestUser();(null==t?void 0:t.sessionId)&&(r["x-guest-session"]=t.sessionId)}let n=await fetch(t,{...e||{},headers:r});return n.ok||console.warn("HTTP ".concat(n.status,": ").concat(n.statusText," for ").concat(t)),n}catch(t){throw console.error("Network error in tRPC request:",t),t}}})],f=(0,r.ec)(),h=f.createClient({links:d})},8092:function(t,e,s){"use strict";s.d(e,{cn:function(){return o},q:function(){return a}});var r=s(1057),n=s(8755);function o(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];return(0,n.m6)((0,r.W)(e))}let a={log:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s]},warn:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s]},error:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];console.error(...e)},info:function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s]}}},3693:function(){}},function(t){t.O(0,[237,198,311,336,293,32,830,915,264,744],function(){return t(t.s=1656)}),_N_E=t.O()}]);